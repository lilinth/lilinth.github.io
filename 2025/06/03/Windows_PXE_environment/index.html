<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Windows PXE 自动化部署环境搭建指南 | FrankTest</title><meta name="author" content="Frank"><meta name="copyright" content="Frank"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="🌐 Windows PXE 自动化部署环境搭建指南 ✅ 一、环境准备与网络配置 🧾 步骤 1：配置服务器静态 IP（IPv4 和 IPv6） 控制面板 → 网络和共享中心 → 更改适配器设置  右键网络 → 属性 → 选择 IPv4 和 IPv6 → 属性  示例配置：  IPv4：  IP 地址：192.168.10.1 子网掩码：255.255.255.0 默认网关：192.168.10.">
<meta property="og:type" content="article">
<meta property="og:title" content="Windows PXE 自动化部署环境搭建指南">
<meta property="og:url" content="https://blog.franktest.net/2025/06/03/Windows_PXE_environment/index.html">
<meta property="og:site_name" content="FrankTest">
<meta property="og:description" content="🌐 Windows PXE 自动化部署环境搭建指南 ✅ 一、环境准备与网络配置 🧾 步骤 1：配置服务器静态 IP（IPv4 和 IPv6） 控制面板 → 网络和共享中心 → 更改适配器设置  右键网络 → 属性 → 选择 IPv4 和 IPv6 → 属性  示例配置：  IPv4：  IP 地址：192.168.10.1 子网掩码：255.255.255.0 默认网关：192.168.10.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lilinth.github.io/picx-images-hosting/IMG_3119.7ljwz5axp7.webp">
<meta property="article:published_time" content="2025-06-03T16:00:00.000Z">
<meta property="article:modified_time" content="2025-06-09T16:00:00.000Z">
<meta property="article:author" content="Frank">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="PXE">
<meta property="article:tag" content="DHCP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lilinth.github.io/picx-images-hosting/IMG_3119.7ljwz5axp7.webp"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.franktest.net/2025/06/03/Windows_PXE_environment/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.14.0-b3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>(()=>{
      const saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
      
      window.btf = {
        saveToLocal: saveToLocal,
        getScript: (url, attr = {}) => new Promise((resolve, reject) => {
          const script = document.createElement('script')
          script.src = url
          script.async = true
          script.onerror = reject
          script.onload = script.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            script.onload = script.onreadystatechange = null
            resolve()
          }

          Object.keys(attr).forEach(key => {
            script.setAttribute(key, attr[key])
          })

          document.head.appendChild(script)
        }),

        getCSS: (url, id = false) => new Promise((resolve, reject) => {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = url
          if (id) link.id = id
          link.onerror = reject
          link.onload = link.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            link.onload = link.onreadystatechange = null
            resolve()
          }
          document.head.appendChild(link)
        }),

        addGlobalFn: (key, fn, name = false, parent = window) => {
          const pjaxEnable = false
          if (!pjaxEnable && key.startsWith('pjax')) return

          const globalFn = parent.globalFn || {}
          const keyObj = globalFn[key] || {}
    
          if (name && keyObj[name]) return
    
          name = name || Object.keys(keyObj).length
          keyObj[name] = fn
          globalFn[key] = keyObj
          parent.globalFn = globalFn
        }
      }
    
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode
      
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })()</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Windows PXE 自动化部署环境搭建指南',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-10 00:00:00'
}</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://lilinth.github.io/picx-images-hosting/IMG_3119.7ljwz5axp7.webp" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="FrankTest"><span class="site-name">FrankTest</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Windows PXE 自动化部署环境搭建指南</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-06-03T16:00:00.000Z" title="发表于 2025-06-04 00:00:00">2025-06-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-09T16:00:00.000Z" title="更新于 2025-06-10 00:00:00">2025-06-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Windows PXE 自动化部署环境搭建指南"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="🌐-Windows-PXE-自动化部署环境搭建指南"><a href="#🌐-Windows-PXE-自动化部署环境搭建指南" class="headerlink" title="🌐 Windows PXE 自动化部署环境搭建指南"></a>🌐 Windows PXE 自动化部署环境搭建指南</h1><hr>
<h2 id="✅-一、环境准备与网络配置"><a href="#✅-一、环境准备与网络配置" class="headerlink" title="✅ 一、环境准备与网络配置"></a>✅ 一、环境准备与网络配置</h2><hr>
<h3 id="🧾-步骤-1：配置服务器静态-IP（IPv4-和-IPv6）"><a href="#🧾-步骤-1：配置服务器静态-IP（IPv4-和-IPv6）" class="headerlink" title="🧾 步骤 1：配置服务器静态 IP（IPv4 和 IPv6）"></a>🧾 步骤 1：配置服务器静态 IP（IPv4 和 IPv6）</h3><ol>
<li><p>控制面板 → 网络和共享中心 → 更改适配器设置</p>
</li>
<li><p>右键网络 → 属性 → 选择 <code>IPv4</code> 和 <code>IPv6</code> → 属性</p>
</li>
<li><p>示例配置：</p>
<ul>
<li><p>IPv4：</p>
<ul>
<li>IP 地址：<code>192.168.10.1</code></li>
<li>子网掩码：<code>255.255.255.0</code></li>
<li>默认网关：<code>192.168.10.1</code></li>
</ul>
</li>
<li><p>IPv6：</p>
<ul>
<li>地址：<code>fd00:10::1</code></li>
<li>前缀长度：<code>64</code></li>
<li>网关：<code>fd00:10::1</code></li>
</ul>
</li>
</ul>
</li>
<li><p>点击”确定”保存</p>
</li>
</ol>
<hr>
<h3 id="🧾-步骤-2：安装-DHCP-和-DNS-服务"><a href="#🧾-步骤-2：安装-DHCP-和-DNS-服务" class="headerlink" title="🧾 步骤 2：安装 DHCP 和 DNS 服务"></a>🧾 步骤 2：安装 DHCP 和 DNS 服务</h3><ol>
<li><p>打开 <strong>服务器管理器</strong></p>
</li>
<li><p>点击”添加角色和功能”</p>
</li>
<li><p>选择：</p>
<ul>
<li>✅ DHCP Server（DHCP 服务器）</li>
<li>✅ DNS Server（DNS 服务器）</li>
</ul>
</li>
<li><p>一路”下一步”直到安装完成</p>
</li>
<li><p>安装完成后根据提示启动 DHCP 配置向导并完成设置</p>
</li>
</ol>
<hr>
<h2 id="✅-二、配置-DHCPv4-和-DHCPv6-服务"><a href="#✅-二、配置-DHCPv4-和-DHCPv6-服务" class="headerlink" title="✅ 二、配置 DHCPv4 和 DHCPv6 服务"></a>✅ 二、配置 DHCPv4 和 DHCPv6 服务</h2><hr>
<h3 id="📌-步骤-3：配置-DHCPv4-服务"><a href="#📌-步骤-3：配置-DHCPv4-服务" class="headerlink" title="📌 步骤 3：配置 DHCPv4 服务"></a>📌 步骤 3：配置 DHCPv4 服务</h3><ol>
<li><p>打开 <strong>DHCP 管理器</strong></p>
</li>
<li><p>右键 <code>IPv4</code> → 新建作用域</p>
</li>
<li><p>设置作用域信息：</p>
<ul>
<li>名称：<code>Internal-Network</code></li>
<li>范围：192.168.10.100 - 192.168.10.199</li>
<li>排除：192.168.10.120 - 192.168.10.129</li>
<li>子网掩码：255.255.255.0</li>
<li>网关：192.168.10.1</li>
<li>DNS：192.168.10.1</li>
</ul>
</li>
<li><p>激活作用域</p>
</li>
</ol>
<hr>
<h3 id="📌-步骤-4：配置-DHCPv6-服务"><a href="#📌-步骤-4：配置-DHCPv6-服务" class="headerlink" title="📌 步骤 4：配置 DHCPv6 服务"></a>📌 步骤 4：配置 DHCPv6 服务</h3><ol>
<li><p>DHCP 管理器中 → <code>IPv6</code> → 新建作用域</p>
</li>
<li><p>配置如下：</p>
<ul>
<li>名称：<code>Internal-IPv6</code></li>
<li>前缀：<code>fd00:10::</code></li>
<li>前缀长度：64</li>
<li>范围编号：1 - 9999</li>
</ul>
</li>
<li><p>完成并激活作用域</p>
</li>
</ol>
<hr>
<h3 id="📌-步骤-5：启用-IPv6-Router-Advertisement（RA）"><a href="#📌-步骤-5：启用-IPv6-Router-Advertisement（RA）" class="headerlink" title="📌 步骤 5：启用 IPv6 Router Advertisement（RA）"></a>📌 步骤 5：启用 IPv6 Router Advertisement（RA）</h3><h4 id="命令行方式："><a href="#命令行方式：" class="headerlink" title="命令行方式："></a>命令行方式：</h4><ol>
<li><p>查询interface id</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">netsh interface ipv6 show interface</span><br><span class="line"></span><br><span class="line">Idx     Met         MTU          State                Name</span><br><span class="line">---  ----------  ----------  ------------  ---------------------------</span><br><span class="line">&lt;interface id&gt;          <span class="number">15</span>        <span class="number">1500</span>  connected     Ethernet</span><br></pre></td></tr></table></figure>
</li>
<li><p>启用 IPv6 转发和 RA 广播</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">netsh interface ipv6 <span class="built_in">set</span> interface &lt;interface id&gt; forwarding=enabled</span><br><span class="line">netsh interface ipv6 <span class="built_in">set</span> interface &lt;interface id&gt; advertised=enabled</span><br><span class="line">netsh interface ipv6 <span class="built_in">set</span> interface &lt;interface id&gt; managedaddress=enabled</span><br><span class="line">netsh interface ipv6 <span class="built_in">set</span> interface &lt;interface id&gt; otherstateful=enabled</span><br><span class="line">netsh interface ipv6 add route fd00:<span class="number">10</span>::/<span class="number">64</span> &lt;interface id&gt; publish=enabled</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查状态</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">netsh interface ipv6 show interface &lt;interface id&gt;</span><br><span class="line">Forwarding                         : enabled</span><br><span class="line">Advertising                        : enabled</span><br><span class="line">Managed Address Configuration      : enabled</span><br><span class="line">Other Stateful Configuration       : enabled</span><br><span class="line"></span><br><span class="line">netsh interface ipv6 show addresses &lt;interface id&gt;</span><br><span class="line">Public     Preferred  <span class="number">29</span>d23h56m28s <span class="number">6</span>d23h56m28s fd00:<span class="number">10</span>::<span class="number">100</span></span><br><span class="line">Dhcp       Preferred      <span class="number">6</span>d23h5m    <span class="number">2</span>d23h5m fd00:<span class="number">10</span>::<span class="number">101</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="图形界面-备用"><a href="#图形界面-备用" class="headerlink" title="图形界面(备用)"></a>图形界面(备用)</h4><blockquote>
<p>Windows DHCPv6 默认不广播前缀，需通过 RRAS 启用 RA</p>
</blockquote>
<ol>
<li><p>打开 <code>路由和远程访问（RRAS）</code></p>
</li>
<li><p>配置为”本地路由模式（LAN Routing）”</p>
</li>
<li><p>网卡 → 右键 → 属性 → IPv6 标签页，勾选：</p>
<ul>
<li>✅ 启用 Router Advertisement</li>
<li>✅ Managed Address Configuration（M 位）</li>
<li>✅ Other Stateful Configuration（O 位）</li>
<li>❌ 广播前缀（根据需求选择）</li>
</ul>
</li>
<li><p>重启 RRAS 服务</p>
</li>
</ol>
<h2 id="✅-三、配置-DNS-服务"><a href="#✅-三、配置-DNS-服务" class="headerlink" title="✅ 三、配置 DNS 服务"></a>✅ 三、配置 DNS 服务</h2><hr>
<h3 id="📌-步骤-6：添加正向查找区域"><a href="#📌-步骤-6：添加正向查找区域" class="headerlink" title="📌 步骤 6：添加正向查找区域"></a>📌 步骤 6：添加正向查找区域</h3><ol>
<li>打开 <code>DNS 管理器</code></li>
<li>右键”正向查找区域” → 新建区域</li>
<li>区域名：如 <code>internal.local</code></li>
<li>类型：主区域，存储在本地服务器</li>
<li>动态更新：选择”仅安全的”或”无”</li>
</ol>
<hr>
<h3 id="📌-步骤-7：添加反向查找区域（IPv4）"><a href="#📌-步骤-7：添加反向查找区域（IPv4）" class="headerlink" title="📌 步骤 7：添加反向查找区域（IPv4）"></a>📌 步骤 7：添加反向查找区域（IPv4）</h3><ol>
<li>DNS 管理器 → 右键”反向查找区域” → 新建区域</li>
<li>网络 ID：如 <code>10.168.192</code></li>
<li>完成命名：<code>10.168.192.in-addr.arpa</code></li>
</ol>
<hr>
<h2 id="✅-四、安装-PXE-所需组件"><a href="#✅-四、安装-PXE-所需组件" class="headerlink" title="✅ 四、安装 PXE 所需组件"></a>✅ 四、安装 PXE 所需组件</h2><hr>
<h3 id="📦-步骤-8：安装软件组件"><a href="#📦-步骤-8：安装软件组件" class="headerlink" title="📦 步骤 8：安装软件组件"></a>📦 步骤 8：安装软件组件</h3><ol>
<li><p><strong>安装 Windows 部署服务（WDS）</strong></p>
<ul>
<li><p>打开”服务器管理器” → 添加角色</p>
</li>
<li><p>勾选：</p>
<ul>
<li>部署服务器</li>
<li>传输服务器</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>安装 Windows ADK + WinPE Add-ons</strong></p>
<ul>
<li><p>下载地址：<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-hardware/get-started/adk-install">Windows ADK 下载</a></p>
</li>
<li><p>选择组件：</p>
<ul>
<li>Deployment Tools</li>
<li>Windows Preinstallation Environment（需 WinPE Add-ons）</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>安装 Microsoft Deployment Toolkit (MDT)</strong></p>
<ul>
<li>下载地址：<a target="_blank" rel="noopener" href="https://www.microsoft.com/en-us/download/details.aspx?id=54259">MDT 下载</a></li>
<li>安装完成后打开：<strong>Deployment Workbench</strong></li>
</ul>
</li>
</ol>
<hr>
<h2 id="✅-五、配置-MDT-部署服务"><a href="#✅-五、配置-MDT-部署服务" class="headerlink" title="✅ 五、配置 MDT 部署服务"></a>✅ 五、配置 MDT 部署服务</h2><hr>
<h3 id="⚙️-步骤-9：创建部署共享目录"><a href="#⚙️-步骤-9：创建部署共享目录" class="headerlink" title="⚙️ 步骤 9：创建部署共享目录"></a>⚙️ 步骤 9：创建部署共享目录</h3><ol>
<li>例如：<code>C:\DeploymentShare</code></li>
<li>Deployment Workbench → Deployment Shares → New Deployment Share</li>
<li>设置路径、共享名、描述</li>
</ol>
<hr>
<h3 id="⚙️-步骤-10：导入操作系统镜像"><a href="#⚙️-步骤-10：导入操作系统镜像" class="headerlink" title="⚙️ 步骤 10：导入操作系统镜像"></a>⚙️ 步骤 10：导入操作系统镜像</h3><ol>
<li>将 ISO 挂载或解压，导入其中的 <code>install.wim</code></li>
<li>Deployment Share → Operating Systems → Import Operating System</li>
</ol>
<hr>
<h3 id="⚙️-步骤-11：创建-Task-Sequence"><a href="#⚙️-步骤-11：创建-Task-Sequence" class="headerlink" title="⚙️ 步骤 11：创建 Task Sequence"></a>⚙️ 步骤 11：创建 Task Sequence</h3><ol>
<li><p>Deployment Share → Task Sequences → New Task Sequence</p>
</li>
<li><p>配置：</p>
<ul>
<li>Task ID：如 <code>WS2025</code></li>
<li>模板：Standard Client Task Sequence</li>
<li>操作系统：选择上一步导入的镜像</li>
</ul>
</li>
</ol>
<hr>
<h3 id="⚙️-步骤-12：配置无人值守部署（CustomSettings-ini-Bootstrap-ini-Task-Squences-Unattend-xml）"><a href="#⚙️-步骤-12：配置无人值守部署（CustomSettings-ini-Bootstrap-ini-Task-Squences-Unattend-xml）" class="headerlink" title="⚙️ 步骤 12：配置无人值守部署（CustomSettings.ini&#x2F;Bootstrap.ini&#x2F;Task Squences&#x2F;Unattend.xml）"></a>⚙️ 步骤 12：配置无人值守部署（CustomSettings.ini&#x2F;Bootstrap.ini&#x2F;Task Squences&#x2F;Unattend.xml）</h3><p><strong>CustomSettings.ini 示例：</strong></p>
<p>路径：<code>C:\DeploymentShare\Control\CustomSettings.ini</code></p>
<p>按照Model, Default的优先级顺序，如果client的Model型号匹配，则使用对应的设置，例如”Standard PC (Q35 + ICH9, 2009)”.</p>
<p>更多参数可以参考<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/intune/configmgr/mdt/properties">MDT 文档</a>.</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Settings]</span></span><br><span class="line"><span class="attr">Priority</span>=Model, Default</span><br><span class="line"><span class="attr">Properties</span>=MyCustomProperty</span><br><span class="line"></span><br><span class="line"><span class="section">[Default]</span></span><br><span class="line"><span class="attr">OSInstall</span>=Y</span><br><span class="line"><span class="attr">SkipDeploymentComplete</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipBDDWelcome</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipTaskSequence</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">TaskSequenceID</span>=WS2025</span><br><span class="line"><span class="attr">SkipCapture</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipComputerName</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipUserData</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipSummary</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipFinalSummary</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipAdminPassword</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">AdminPassword</span>=Passw0rd</span><br><span class="line"><span class="attr">SkipProductKey</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipComputerBackup</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipBitLocker</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipDeploymentType</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">DeploymentType</span>=NEWCOMPUTER</span><br><span class="line"><span class="attr">KeyboardLocale</span>=<span class="number">0409</span>:<span class="number">00000409</span></span><br><span class="line"><span class="attr">UserLocale</span>=en-US</span><br><span class="line"><span class="attr">UILanguage</span>=en-US</span><br><span class="line"><span class="attr">TimeZone</span>=Eastern Standard Time</span><br><span class="line"><span class="attr">SkipLocaleSelection</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">JoinWorkgroup</span>=WORKGROUP</span><br><span class="line"><span class="attr">SkipDomainMembership</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipTimeZone</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">SkipApplications</span>=<span class="literal">YES</span></span><br><span class="line"><span class="attr">Applications001</span>=&#123;<span class="number">2</span>ef0539b-<span class="number">5</span>ba0-<span class="number">4</span>dbc-b8d8-daa573151b3d&#125;</span><br><span class="line"><span class="attr">Applications002</span>=&#123;b174dc6e-c0da-<span class="number">409</span>a-b367-ca42fa541a18&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">[Standard PC (Q35 + ICH9, 2009)]</span></span><br><span class="line"><span class="attr">TaskSequenceID</span>=WS2019</span><br><span class="line"><span class="attr">OSDComputerName</span>=Q35-<span class="comment">#Right(Replace(&quot;%MACAddress001%&quot;,&quot;:&quot;,&quot;&quot;),4)#</span></span><br></pre></td></tr></table></figure>

<p><strong>Bootstrap.ini 示例：</strong></p>
<p>路径：<code>C:\DeploymentShare\Control\Bootstrap.ini</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Settings]</span></span><br><span class="line"><span class="attr">Priority</span>=Default</span><br><span class="line"></span><br><span class="line"><span class="section">[Default]</span></span><br><span class="line"><span class="attr">DeployRoot</span>=\\&lt;wds 主机名&gt;\DeploymentShare$</span><br><span class="line"><span class="attr">UserID</span>=administrator</span><br><span class="line"><span class="attr">UserDomain</span>=domain.com</span><br><span class="line"><span class="attr">UserPassword</span>=Password</span><br><span class="line"><span class="attr">SkipBDDWelcome</span>=<span class="literal">YES</span></span><br></pre></td></tr></table></figure>

<p><strong>Task Squences 示例：</strong></p>
<p>路径: <code>C:\DeploymentShare\Control\&lt;task squence id&gt;\ts.xml</code></p>
<p>启用OS的EMS，添加以下内容到<code>group name=&quot;Install&quot;</code>中的<code>name=&quot;Install Operating System&quot;</code> 之后.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">step</span> <span class="attr">type</span>=<span class="string">&quot;SMS_TaskSequence_RunCommandLineAction&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Enable EMS&quot;</span> <span class="attr">description</span>=<span class="string">&quot;&quot;</span> <span class="attr">disable</span>=<span class="string">&quot;false&quot;</span> <span class="attr">continueOnError</span>=<span class="string">&quot;false&quot;</span> <span class="attr">startIn</span>=<span class="string">&quot;&quot;</span> <span class="attr">successCodeList</span>=<span class="string">&quot;0 3010&quot;</span> <span class="attr">runIn</span>=<span class="string">&quot;WinPEandFullOS&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;PackageID&quot;</span> <span class="attr">property</span>=<span class="string">&quot;PackageID&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;RunAsUser&quot;</span> <span class="attr">property</span>=<span class="string">&quot;RunAsUser&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;LoadProfile&quot;</span> <span class="attr">property</span>=<span class="string">&quot;LoadProfile&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span>&gt;</span>bcdedit /set &#123;default&#125; ems yes<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">step</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">step</span> <span class="attr">type</span>=<span class="string">&quot;SMS_TaskSequence_RunCommandLineAction&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Set EMS settings&quot;</span> <span class="attr">description</span>=<span class="string">&quot;&quot;</span> <span class="attr">disable</span>=<span class="string">&quot;false&quot;</span> <span class="attr">continueOnError</span>=<span class="string">&quot;false&quot;</span> <span class="attr">startIn</span>=<span class="string">&quot;&quot;</span> <span class="attr">successCodeList</span>=<span class="string">&quot;0 3010&quot;</span> <span class="attr">runIn</span>=<span class="string">&quot;WinPEandFullOS&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;PackageID&quot;</span> <span class="attr">property</span>=<span class="string">&quot;PackageID&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;RunAsUser&quot;</span> <span class="attr">property</span>=<span class="string">&quot;RunAsUser&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;LoadProfile&quot;</span> <span class="attr">property</span>=<span class="string">&quot;LoadProfile&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span>&gt;</span>bcdedit /emssettings EMSPORT:1 EMSBAUDRATE:115200<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">step</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>关闭OS防火墙，放到<code>group name=&quot;State Restore&quot;</code>中的<code>step type=&quot;BDD_Gather</code>之后</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">step</span> <span class="attr">type</span>=<span class="string">&quot;SMS_TaskSequence_RunCommandLineAction&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Disable firewall&quot;</span> <span class="attr">description</span>=<span class="string">&quot;&quot;</span> <span class="attr">disable</span>=<span class="string">&quot;false&quot;</span> <span class="attr">continueOnError</span>=<span class="string">&quot;false&quot;</span> <span class="attr">startIn</span>=<span class="string">&quot;&quot;</span> <span class="attr">successCodeList</span>=<span class="string">&quot;0 3010&quot;</span> <span class="attr">runIn</span>=<span class="string">&quot;WinPEandFullOS&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;PackageID&quot;</span> <span class="attr">property</span>=<span class="string">&quot;PackageID&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;RunAsUser&quot;</span> <span class="attr">property</span>=<span class="string">&quot;RunAsUser&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;LoadProfile&quot;</span> <span class="attr">property</span>=<span class="string">&quot;LoadProfile&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span>&gt;</span>netsh advfirewall set allprofiles state off<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">step</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>启用RDP远程桌面，放到<code>group name=&quot;State Restore&quot;</code>中的<code>step type=&quot;BDD_Gather</code>之后</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">step</span> <span class="attr">type</span>=<span class="string">&quot;SMS_TaskSequence_RunCommandLineAction&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Enable RDP&quot;</span> <span class="attr">description</span>=<span class="string">&quot;&quot;</span> <span class="attr">disable</span>=<span class="string">&quot;false&quot;</span> <span class="attr">continueOnError</span>=<span class="string">&quot;false&quot;</span> <span class="attr">startIn</span>=<span class="string">&quot;&quot;</span> <span class="attr">successCodeList</span>=<span class="string">&quot;0 3010&quot;</span> <span class="attr">runIn</span>=<span class="string">&quot;WinPEandFullOS&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;PackageID&quot;</span> <span class="attr">property</span>=<span class="string">&quot;PackageID&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;RunAsUser&quot;</span> <span class="attr">property</span>=<span class="string">&quot;RunAsUser&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;LoadProfile&quot;</span> <span class="attr">property</span>=<span class="string">&quot;LoadProfile&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span>&gt;</span>reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">step</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>Unattend.xml 示例</strong></p>
<p>路径: <code>C:\DeploymentShare\Control\&lt;task squence id&gt;\unattend.xml</code></p>
<p>设置ProductKey, key可以参考<a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/windows-server/get-started/kms-client-activation-keys">https://learn.microsoft.com/en-us/windows-server/get-started/kms-client-activation-keys</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">name</span>=<span class="string">&quot;Microsoft-Windows-Shell-Setup&quot;</span> <span class="attr">processorArchitecture</span>=<span class="string">&quot;amd64&quot;</span> <span class="attr">publicKeyToken</span>=<span class="string">&quot;31bf3856ad364e35&quot;</span> <span class="attr">language</span>=<span class="string">&quot;neutral&quot;</span> <span class="attr">versionScope</span>=<span class="string">&quot;nonSxS&quot;</span> <span class="attr">xmlns:wcm</span>=<span class="string">&quot;http://schemas.microsoft.com/WMIConfig/2002/State&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ProductKey</span>&gt;</span>xxxxx-xxxxx-xxxxx-xxxxx-xxxxx<span class="tag">&lt;/<span class="name">ProductKey</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="⚙️-步骤-13：集成UltraVNC到WinPE"><a href="#⚙️-步骤-13：集成UltraVNC到WinPE" class="headerlink" title="⚙️ 步骤 13：集成UltraVNC到WinPE"></a>⚙️ 步骤 13：集成UltraVNC到WinPE</h3><ol>
<li>下载<a target="_blank" rel="noopener" href="https://uvnc.com/downloads/ultravnc/163-ultravnc-1-6-1-00.html">UltraVNC</a> <code>UltraVNC x.x.x.x.zip</code></li>
<li>解压缩文件，并且将x64改名为VNC, 放到<code>C:\DeploymentShare\ExtraFiles</code>下面</li>
<li>编辑或创建<code>VNC\UltraVNC.ini</code>, 添加以下内容，为<code>111111</code> base64编码后的值<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[UltraVNC]</span></span><br><span class="line"><span class="attr">passwd</span>=<span class="number">9065</span>AD0D054101281E</span><br></pre></td></tr></table></figure></li>
<li>Deployment Share → 右键 → Properties → Windows PE → Platform → x64 → Exatra directory to add: → <code>C:\DeploymentShare\ExtraFiles</code> 然后保存</li>
<li>编辑<code>C:\DeploymentShare\Control\&lt;task squence id&gt;\ts.xml</code>, 添加以下内容到<code>group name=&quot;Initialization&quot;</code>, 关闭WinPE 防火墙并且运行UltraVNC<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">step</span> <span class="attr">type</span>=<span class="string">&quot;SMS_TaskSequence_RunCommandLineAction&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Disable firewall&quot;</span> <span class="attr">description</span>=<span class="string">&quot;&quot;</span> <span class="attr">disable</span>=<span class="string">&quot;false&quot;</span> <span class="attr">continueOnError</span>=<span class="string">&quot;false&quot;</span> <span class="attr">startIn</span>=<span class="string">&quot;&quot;</span> <span class="attr">successCodeList</span>=<span class="string">&quot;0 3010&quot;</span> <span class="attr">runIn</span>=<span class="string">&quot;WinPEandFullOS&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;PackageID&quot;</span> <span class="attr">property</span>=<span class="string">&quot;PackageID&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;RunAsUser&quot;</span> <span class="attr">property</span>=<span class="string">&quot;RunAsUser&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;LoadProfile&quot;</span> <span class="attr">property</span>=<span class="string">&quot;LoadProfile&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span>&gt;</span>Wpeutil DisableFirewall<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">step</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">step</span> <span class="attr">type</span>=<span class="string">&quot;SMS_TaskSequence_RunCommandLineAction&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Start VNC&quot;</span> <span class="attr">description</span>=<span class="string">&quot;&quot;</span> <span class="attr">disable</span>=<span class="string">&quot;false&quot;</span> <span class="attr">continueOnError</span>=<span class="string">&quot;false&quot;</span> <span class="attr">startIn</span>=<span class="string">&quot;&quot;</span> <span class="attr">successCodeList</span>=<span class="string">&quot;0 3010&quot;</span> <span class="attr">runIn</span>=<span class="string">&quot;WinPEandFullOS&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;PackageID&quot;</span> <span class="attr">property</span>=<span class="string">&quot;PackageID&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;RunAsUser&quot;</span> <span class="attr">property</span>=<span class="string">&quot;RunAsUser&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span> <span class="attr">property</span>=<span class="string">&quot;SMSTSRunCommandLineUserPassword&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">variable</span> <span class="attr">name</span>=<span class="string">&quot;LoadProfile&quot;</span> <span class="attr">property</span>=<span class="string">&quot;LoadProfile&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">variable</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defaultVarList</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">action</span>&gt;</span>cmd.exe /c start &quot;&quot; X:\VNC\winvnc.exe -run<span class="tag">&lt;/<span class="name">action</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">step</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li>在启动WinPE之后，可以使用UltraVNC连接PXE分配的IP打开VNC窗口，密码为设置的<code>111111</code></li>
</ol>
<hr>
<hr>
<h3 id="⚙️-步骤-14：生成-LiteTouchPE-引导镜像"><a href="#⚙️-步骤-14：生成-LiteTouchPE-引导镜像" class="headerlink" title="⚙️ 步骤 14：生成 LiteTouchPE 引导镜像"></a>⚙️ 步骤 14：生成 LiteTouchPE 引导镜像</h3><ol>
<li>Deployment Share → 右键 → Update Deployment Share</li>
<li>自动生成 <code>LiteTouchPE_x64.wim</code>，路径如下：<br><code>C:\DeploymentShare\Boot\LiteTouchPE_x64.wim</code></li>
</ol>
<hr>
<h2 id="✅-六、配置-WDS（PXE-启动服务）"><a href="#✅-六、配置-WDS（PXE-启动服务）" class="headerlink" title="✅ 六、配置 WDS（PXE 启动服务）"></a>✅ 六、配置 WDS（PXE 启动服务）</h2><hr>
<h3 id="🧩-步骤-15：配置-WDS-基础设置"><a href="#🧩-步骤-15：配置-WDS-基础设置" class="headerlink" title="🧩 步骤 15：配置 WDS 基础设置"></a>🧩 步骤 15：配置 WDS 基础设置</h3><ol>
<li>打开”Windows 部署服务”管理器</li>
<li>设置 RemoteInstall 路径（如：<code>C:\RemoteInstall</code>）</li>
<li>设置响应所有客户端（包括未知客户端）</li>
</ol>
<hr>
<h3 id="🧩-步骤-16：添加引导镜像"><a href="#🧩-步骤-16：添加引导镜像" class="headerlink" title="🧩 步骤 16：添加引导镜像"></a>🧩 步骤 16：添加引导镜像</h3><ol>
<li>WDS → Boot Images → Add Boot Image</li>
<li>选择前面生成的 <code>LiteTouchPE_x64.wim</code></li>
</ol>
<hr>
<h3 id="🧩-步骤-17：可选安装镜像导入"><a href="#🧩-步骤-17：可选安装镜像导入" class="headerlink" title="🧩 步骤 17：可选安装镜像导入"></a>🧩 步骤 17：可选安装镜像导入</h3><ol>
<li>从 ISO 中提取 <code>install.wim</code></li>
<li>WDS → Install Images → Add Image Group → 导入 <code>install.wim</code></li>
</ol>
<hr>
<h2 id="✅-七、串口控制台（EMS）可选配置"><a href="#✅-七、串口控制台（EMS）可选配置" class="headerlink" title="✅ 七、串口控制台（EMS）可选配置"></a>✅ 七、串口控制台（EMS）可选配置</h2><hr>
<h3 id="🧵-步骤-18：启用-EMS（串口控制）"><a href="#🧵-步骤-18：启用-EMS（串口控制）" class="headerlink" title="🧵 步骤 18：启用 EMS（串口控制）"></a>🧵 步骤 18：启用 EMS（串口控制）</h3><ol>
<li><p>查询BCD中bootload 的identifier</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /store &quot;C:\RemoteInstall\Boot\x64\Images\LiteTouchPE_x64.wim.bcd&quot; /enum</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置指定identifier的EMS ON</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /store &quot;C:\RemoteInstall\Boot\x64\Images\LiteTouchPE_x64.wim.bcd&quot; /ems &#123;&lt;identifier&gt;&#125; ON</span><br></pre></td></tr></table></figure>
</li>
<li><p>再次检查BCD是否包含 <code>ems Yes</code></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bcdedit /store &quot;C:\RemoteInstall\Boot\x64\Images\LiteTouchPE_x64.wim.bcd&quot; /enum</span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>⚠️ 注意：务必使用 <code>/store</code> 指定 <code>.bcd</code> 文件路径，否则可能更改当前系统引导配置。</p>
</blockquote>
<hr>
<h2 id="✅-八、客户端部署测试与验证"><a href="#✅-八、客户端部署测试与验证" class="headerlink" title="✅ 八、客户端部署测试与验证"></a>✅ 八、客户端部署测试与验证</h2><hr>
<h3 id="🧪-步骤-19：客户端启动配置"><a href="#🧪-步骤-19：客户端启动配置" class="headerlink" title="🧪 步骤 19：客户端启动配置"></a>🧪 步骤 19：客户端启动配置</h3><ol>
<li>BIOS&#x2F;UEFI 中设置 PXE 启动优先</li>
<li>启动后应进入 MDT LiteTouch PE 环境</li>
<li>自动执行无人值守部署任务序列</li>
</ol>
<hr>
<h3 id="🧪-步骤-20：验证-DHCP-和-DNS-正常工作"><a href="#🧪-步骤-20：验证-DHCP-和-DNS-正常工作" class="headerlink" title="🧪 步骤 20：验证 DHCP 和 DNS 正常工作"></a>🧪 步骤 20：验证 DHCP 和 DNS 正常工作</h3><p>客户端设置为自动获取 IP<br>执行命令：</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ipconfig</span> /release</span><br><span class="line"><span class="built_in">ipconfig</span> /renew</span><br><span class="line"><span class="built_in">ipconfig</span> /all</span><br><span class="line">nslookup internal.local</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="✅-九、静态地址分配（保留地址）"><a href="#✅-九、静态地址分配（保留地址）" class="headerlink" title="✅ 九、静态地址分配（保留地址）"></a>✅ 九、静态地址分配（保留地址）</h2><hr>
<h3 id="📌-DHCPv4-保留地址"><a href="#📌-DHCPv4-保留地址" class="headerlink" title="📌 DHCPv4 保留地址"></a>📌 DHCPv4 保留地址</h3><ol>
<li>DHCP 管理器 → IPv4 → Reservations</li>
<li>新建 → 输入 MAC 地址与 IP 进行保留</li>
</ol>
<hr>
<h3 id="📌-DHCPv6-保留地址"><a href="#📌-DHCPv6-保留地址" class="headerlink" title="📌 DHCPv6 保留地址"></a>📌 DHCPv6 保留地址</h3><ol>
<li>客户端执行 <code>ipconfig /all</code> 获取 <strong>DUID</strong></li>
<li>DHCP 管理器 → IPv6 → Reservations → 新建保留地址并输入 DUID</li>
</ol>
<hr>
<h2 id="✅-十、故障排查与日志定位"><a href="#✅-十、故障排查与日志定位" class="headerlink" title="✅ 十、故障排查与日志定位"></a>✅ 十、故障排查与日志定位</h2><hr>
<h3 id="🔧-常见日志路径"><a href="#🔧-常见日志路径" class="headerlink" title="🔧 常见日志路径"></a>🔧 常见日志路径</h3><table>
<thead>
<tr>
<th>阶段</th>
<th>日志路径</th>
</tr>
</thead>
<tbody><tr>
<td>WinPE 阶段</td>
<td><code>X:\MININT\SMSOSD\OSDLOGS\</code></td>
</tr>
<tr>
<td>安装中</td>
<td><code>C:\MININT\SMSOSD\OSDLOGS\</code></td>
</tr>
<tr>
<td>安装后</td>
<td><code>C:\Windows\Temp\DeploymentLogs\</code></td>
</tr>
</tbody></table>
<hr>
<h3 id="🧹-清除失败部署缓存（避免”in-progress”错误）"><a href="#🧹-清除失败部署缓存（避免”in-progress”错误）" class="headerlink" title="🧹 清除失败部署缓存（避免”in-progress”错误）"></a>🧹 清除失败部署缓存（避免”in-progress”错误）</h3><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rd</span> /s /q C:\MININT</span><br><span class="line"><span class="built_in">rd</span> /s /q C:\_SMSTaskSequence</span><br><span class="line"><span class="built_in">del</span> /f /q C:\*.xml</span><br></pre></td></tr></table></figure>

<hr>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.franktest.net">Frank</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.franktest.net/2025/06/03/Windows_PXE_environment/">https://blog.franktest.net/2025/06/03/Windows_PXE_environment/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.franktest.net" target="_blank">FrankTest</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/PXE/">PXE</a><a class="post-meta__tags" href="/tags/DHCP/">DHCP</a></div><div class="post_share"><div class="social-share" data-image="https://lilinth.github.io/picx-images-hosting/IMG_3119.7ljwz5axp7.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/07/30/windows_wql_query/" title="Windows WQL 查询"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Windows WQL 查询</div></div></a></div><div class="next-post pull-right"><a href="/2025/06/03/amd_intel_processor_roadmap/" title="Intel和AMD服务器处理器路线图"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Intel和AMD服务器处理器路线图</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2025/08/19/Integrate_windows_patch_to_install_file/" title="集成Windows 补丁到安装文件"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-20</div><div class="title">集成Windows 补丁到安装文件</div></div></a></div><div><a href="/2025/07/30/haproxy_rdp_configuration/" title="HAProxy 转发 Windows RDP"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-31</div><div class="title">HAProxy 转发 Windows RDP</div></div></a></div><div><a href="/2025/07/30/psexec_access_is_denied/" title="PsExec 访问被拒绝问题排查和解决"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-31</div><div class="title">PsExec 访问被拒绝问题排查和解决</div></div></a></div><div><a href="/2025/07/30/windows_wql_query/" title="Windows WQL 查询"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-31</div><div class="title">Windows WQL 查询</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://lilinth.github.io/picx-images-hosting/IMG_3119.7ljwz5axp7.webp" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Frank</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">49</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">42</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Frank's Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%F0%9F%8C%90-Windows-PXE-%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E6%8C%87%E5%8D%97"><span class="toc-number">1.</span> <span class="toc-text">🌐 Windows PXE 自动化部署环境搭建指南</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E4%B8%80%E3%80%81%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87%E4%B8%8E%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="toc-number">1.1.</span> <span class="toc-text">✅ 一、环境准备与网络配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%BE-%E6%AD%A5%E9%AA%A4-1%EF%BC%9A%E9%85%8D%E7%BD%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%9D%99%E6%80%81-IP%EF%BC%88IPv4-%E5%92%8C-IPv6%EF%BC%89"><span class="toc-number">1.1.1.</span> <span class="toc-text">🧾 步骤 1：配置服务器静态 IP（IPv4 和 IPv6）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%BE-%E6%AD%A5%E9%AA%A4-2%EF%BC%9A%E5%AE%89%E8%A3%85-DHCP-%E5%92%8C-DNS-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.1.2.</span> <span class="toc-text">🧾 步骤 2：安装 DHCP 和 DNS 服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE-DHCPv4-%E5%92%8C-DHCPv6-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.</span> <span class="toc-text">✅ 二、配置 DHCPv4 和 DHCPv6 服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C-%E6%AD%A5%E9%AA%A4-3%EF%BC%9A%E9%85%8D%E7%BD%AE-DHCPv4-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.1.</span> <span class="toc-text">📌 步骤 3：配置 DHCPv4 服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C-%E6%AD%A5%E9%AA%A4-4%EF%BC%9A%E9%85%8D%E7%BD%AE-DHCPv6-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.2.2.</span> <span class="toc-text">📌 步骤 4：配置 DHCPv6 服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C-%E6%AD%A5%E9%AA%A4-5%EF%BC%9A%E5%90%AF%E7%94%A8-IPv6-Router-Advertisement%EF%BC%88RA%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">📌 步骤 5：启用 IPv6 Router Advertisement（RA）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%96%B9%E5%BC%8F%EF%BC%9A"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">命令行方式：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2-%E5%A4%87%E7%94%A8"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">图形界面(备用)</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E4%B8%89%E3%80%81%E9%85%8D%E7%BD%AE-DNS-%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.</span> <span class="toc-text">✅ 三、配置 DNS 服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C-%E6%AD%A5%E9%AA%A4-6%EF%BC%9A%E6%B7%BB%E5%8A%A0%E6%AD%A3%E5%90%91%E6%9F%A5%E6%89%BE%E5%8C%BA%E5%9F%9F"><span class="toc-number">1.3.1.</span> <span class="toc-text">📌 步骤 6：添加正向查找区域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C-%E6%AD%A5%E9%AA%A4-7%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%8F%8D%E5%90%91%E6%9F%A5%E6%89%BE%E5%8C%BA%E5%9F%9F%EF%BC%88IPv4%EF%BC%89"><span class="toc-number">1.3.2.</span> <span class="toc-text">📌 步骤 7：添加反向查找区域（IPv4）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E5%9B%9B%E3%80%81%E5%AE%89%E8%A3%85-PXE-%E6%89%80%E9%9C%80%E7%BB%84%E4%BB%B6"><span class="toc-number">1.4.</span> <span class="toc-text">✅ 四、安装 PXE 所需组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%A6-%E6%AD%A5%E9%AA%A4-8%EF%BC%9A%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E7%BB%84%E4%BB%B6"><span class="toc-number">1.4.1.</span> <span class="toc-text">📦 步骤 8：安装软件组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E4%BA%94%E3%80%81%E9%85%8D%E7%BD%AE-MDT-%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.5.</span> <span class="toc-text">✅ 五、配置 MDT 部署服务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%AD%A5%E9%AA%A4-9%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%83%A8%E7%BD%B2%E5%85%B1%E4%BA%AB%E7%9B%AE%E5%BD%95"><span class="toc-number">1.5.1.</span> <span class="toc-text">⚙️ 步骤 9：创建部署共享目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%AD%A5%E9%AA%A4-10%EF%BC%9A%E5%AF%BC%E5%85%A5%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E9%95%9C%E5%83%8F"><span class="toc-number">1.5.2.</span> <span class="toc-text">⚙️ 步骤 10：导入操作系统镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%AD%A5%E9%AA%A4-11%EF%BC%9A%E5%88%9B%E5%BB%BA-Task-Sequence"><span class="toc-number">1.5.3.</span> <span class="toc-text">⚙️ 步骤 11：创建 Task Sequence</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%AD%A5%E9%AA%A4-12%EF%BC%9A%E9%85%8D%E7%BD%AE%E6%97%A0%E4%BA%BA%E5%80%BC%E5%AE%88%E9%83%A8%E7%BD%B2%EF%BC%88CustomSettings-ini-Bootstrap-ini-Task-Squences-Unattend-xml%EF%BC%89"><span class="toc-number">1.5.4.</span> <span class="toc-text">⚙️ 步骤 12：配置无人值守部署（CustomSettings.ini&#x2F;Bootstrap.ini&#x2F;Task Squences&#x2F;Unattend.xml）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%AD%A5%E9%AA%A4-13%EF%BC%9A%E9%9B%86%E6%88%90UltraVNC%E5%88%B0WinPE"><span class="toc-number">1.5.5.</span> <span class="toc-text">⚙️ 步骤 13：集成UltraVNC到WinPE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9A%99%EF%B8%8F-%E6%AD%A5%E9%AA%A4-14%EF%BC%9A%E7%94%9F%E6%88%90-LiteTouchPE-%E5%BC%95%E5%AF%BC%E9%95%9C%E5%83%8F"><span class="toc-number">1.5.6.</span> <span class="toc-text">⚙️ 步骤 14：生成 LiteTouchPE 引导镜像</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E5%85%AD%E3%80%81%E9%85%8D%E7%BD%AE-WDS%EF%BC%88PXE-%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1%EF%BC%89"><span class="toc-number">1.6.</span> <span class="toc-text">✅ 六、配置 WDS（PXE 启动服务）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%A9-%E6%AD%A5%E9%AA%A4-15%EF%BC%9A%E9%85%8D%E7%BD%AE-WDS-%E5%9F%BA%E7%A1%80%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.6.1.</span> <span class="toc-text">🧩 步骤 15：配置 WDS 基础设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%A9-%E6%AD%A5%E9%AA%A4-16%EF%BC%9A%E6%B7%BB%E5%8A%A0%E5%BC%95%E5%AF%BC%E9%95%9C%E5%83%8F"><span class="toc-number">1.6.2.</span> <span class="toc-text">🧩 步骤 16：添加引导镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%A9-%E6%AD%A5%E9%AA%A4-17%EF%BC%9A%E5%8F%AF%E9%80%89%E5%AE%89%E8%A3%85%E9%95%9C%E5%83%8F%E5%AF%BC%E5%85%A5"><span class="toc-number">1.6.3.</span> <span class="toc-text">🧩 步骤 17：可选安装镜像导入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E4%B8%83%E3%80%81%E4%B8%B2%E5%8F%A3%E6%8E%A7%E5%88%B6%E5%8F%B0%EF%BC%88EMS%EF%BC%89%E5%8F%AF%E9%80%89%E9%85%8D%E7%BD%AE"><span class="toc-number">1.7.</span> <span class="toc-text">✅ 七、串口控制台（EMS）可选配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%B5-%E6%AD%A5%E9%AA%A4-18%EF%BC%9A%E5%90%AF%E7%94%A8-EMS%EF%BC%88%E4%B8%B2%E5%8F%A3%E6%8E%A7%E5%88%B6%EF%BC%89"><span class="toc-number">1.7.1.</span> <span class="toc-text">🧵 步骤 18：启用 EMS（串口控制）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E5%85%AB%E3%80%81%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%83%A8%E7%BD%B2%E6%B5%8B%E8%AF%95%E4%B8%8E%E9%AA%8C%E8%AF%81"><span class="toc-number">1.8.</span> <span class="toc-text">✅ 八、客户端部署测试与验证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%AA-%E6%AD%A5%E9%AA%A4-19%EF%BC%9A%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE"><span class="toc-number">1.8.1.</span> <span class="toc-text">🧪 步骤 19：客户端启动配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%AA-%E6%AD%A5%E9%AA%A4-20%EF%BC%9A%E9%AA%8C%E8%AF%81-DHCP-%E5%92%8C-DNS-%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.8.2.</span> <span class="toc-text">🧪 步骤 20：验证 DHCP 和 DNS 正常工作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E4%B9%9D%E3%80%81%E9%9D%99%E6%80%81%E5%9C%B0%E5%9D%80%E5%88%86%E9%85%8D%EF%BC%88%E4%BF%9D%E7%95%99%E5%9C%B0%E5%9D%80%EF%BC%89"><span class="toc-number">1.9.</span> <span class="toc-text">✅ 九、静态地址分配（保留地址）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C-DHCPv4-%E4%BF%9D%E7%95%99%E5%9C%B0%E5%9D%80"><span class="toc-number">1.9.1.</span> <span class="toc-text">📌 DHCPv4 保留地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%93%8C-DHCPv6-%E4%BF%9D%E7%95%99%E5%9C%B0%E5%9D%80"><span class="toc-number">1.9.2.</span> <span class="toc-text">📌 DHCPv6 保留地址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E2%9C%85-%E5%8D%81%E3%80%81%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5%E4%B8%8E%E6%97%A5%E5%BF%97%E5%AE%9A%E4%BD%8D"><span class="toc-number">1.10.</span> <span class="toc-text">✅ 十、故障排查与日志定位</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%94%A7-%E5%B8%B8%E8%A7%81%E6%97%A5%E5%BF%97%E8%B7%AF%E5%BE%84"><span class="toc-number">1.10.1.</span> <span class="toc-text">🔧 常见日志路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A7%B9-%E6%B8%85%E9%99%A4%E5%A4%B1%E8%B4%A5%E9%83%A8%E7%BD%B2%E7%BC%93%E5%AD%98%EF%BC%88%E9%81%BF%E5%85%8D%E2%80%9Din-progress%E2%80%9D%E9%94%99%E8%AF%AF%EF%BC%89"><span class="toc-number">1.10.2.</span> <span class="toc-text">🧹 清除失败部署缓存（避免”in-progress”错误）</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/25/NVME_BDF_physical_location_mapping/" title="NVME BDF 与物理位置映射">NVME BDF 与物理位置映射</a><time datetime="2025-08-25T16:00:00.000Z" title="发表于 2025-08-26 00:00:00">2025-08-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/19/Integrate_windows_patch_to_install_file/" title="集成Windows 补丁到安装文件">集成Windows 补丁到安装文件</a><time datetime="2025-08-19T16:00:00.000Z" title="发表于 2025-08-20 00:00:00">2025-08-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/14/ssh_server_cannot_start_too_open/" title="SSH 服务无法启动：私钥权限过于开放">SSH 服务无法启动：私钥权限过于开放</a><time datetime="2025-08-14T16:00:00.000Z" title="发表于 2025-08-15 00:00:00">2025-08-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/30/RTC_Crystal/" title="RTC 晶振与温度的关系">RTC 晶振与温度的关系</a><time datetime="2025-07-30T16:00:00.000Z" title="发表于 2025-07-31 00:00:00">2025-07-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/30/haproxy_rdp_configuration/" title="HAProxy 转发 Windows RDP">HAProxy 转发 Windows RDP</a><time datetime="2025-07-30T16:00:00.000Z" title="发表于 2025-07-31 00:00:00">2025-07-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Frank</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.14.0-b3"></script><script src="/js/main.js?v=4.14.0-b3"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  const runMermaid = (ele) => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from(ele).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return
    
    codeMermaidEle.forEach(ele => {
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.innerHTML = `<pre class="mermaid-src" hidden>${ele.textContent}</pre>`
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js').then(runMermaidFn)
  }
  
  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>(() => {
  const disqus_config = function () {
    this.page.url = 'https://blog.franktest.net/2025/06/03/Windows_PXE_environment/'
    this.page.identifier = '/2025/06/03/Windows_PXE_environment/'
    this.page.title = 'Windows PXE 自动化部署环境搭建指南'
  }

  const disqusReset = () => {
    window.DISQUS && window.DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addGlobalFn('themeChange', disqusReset, 'disqus')

  const loadDisqus = () =>{
    if (window.DISQUS) disqusReset()
    else {
      const script = document.createElement('script')
      script.src = 'https://frank-reoyq9vbgl.disqus.com/embed.js'
      script.setAttribute('data-timestamp', +new Date())
      document.head.appendChild(script)
    }
  }

  const getCount = async() => {
    try {
      const eleGroup = document.querySelector('#post-meta .disqus-comment-count')
      if (!eleGroup) return
      const cleanedLinks = eleGroup.href.replace(/#post-comment$/, '')

      const res = await fetch(`https://disqus.com/api/3.0/threads/set.json?forum=frank-reoyq9vbgl&api_key=&thread:link=${cleanedLinks}`,{
        method: 'GET'
      })
      const result = await res.json()

      const count = result.response.length ? result.response[0].posts : 0
      eleGroup.textContent = count
    } catch (err) {
      console.error(err)
    }
  }

  if ('Disqus' === 'Disqus' || !false) {
    if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
    else {
      loadDisqus()
      
    }
  } else {
    window.loadOtherComment = loadDisqus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.14.0-b3"></script></div></div></body></html>